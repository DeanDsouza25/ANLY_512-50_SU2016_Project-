---
title: "Project Report"
author: "Dean D'souza"
date: "`r Sys.Date()`"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyr)
library(ggplot2)
library(plotly)
```

## Data Collection  
  
  The data collection process was done over a period of roughly 44 days (from 06/22/2016 - 08/04/2016) and was driven by the following main questions:  
  
  1. How well have I managed my expenditure in various categories over the span of the month?(Keeping a $60 a day as acceptable and ideal)  
  2. On average how well have I distributed my time across activities I perform on a near regular basis?    
  3. Does spending time on any particular activity have an influence of my overall mood on that day?  
  4. Does the amount I walk around in a day help or in any way affect the amount I sleep?
  
  The data I gathered to answer these questions were limited due to various constraints and were mainly manually input into a microsoft excel file which was converted to .csv format for ease of use with R (mainly due to familiarity on working with the format).  
  The data can hence be described as follows:  
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
# Setting up the contents for table of descriptions
desc<-data.frame(
  c("Day","Date","Groceries&Supplies","EatingOut","Amazon","Misc","Uber","OtherMOT","Total","DistTrav","DistWalk","Area","HrsSleep","HrsStudy","HrsRead","HrsYoutube","HrsNetflix","HrsESO","Mood"),
  c("The day of the week","The date","Amount spent on groceries and other supplies for the house","Amount spent on ordering from restaurants or on other items such as coffee","Amount spent on Amazon","Amount spent on other unrelated items that would normally be a one time purchase","Amount spent on Uber rides","Amount spent on other modes of transpot(mostly buses and NYC Subway)","Total Amount spent on that day","Distance traveled by modes of transport","Distance walked (leisurely or to stores and back)","Area I ended up at the end of the day","Hours of sleep I got (From the previous night to the current day)","Time spent studying (including coding and attending class, in hours)","Time spent reading (News, Papers,Reddit, etc., in hours)","Time spent watching videos on YouTube (in hours)","Time spent watching series or movies on Netflix (in hours)","Time spent on Elder Scrolls Online (in hours)","My overall mood on that day")
  )

# Displaying the Table
kable(desc,format = "pandoc", caption="Variables Description", col.names = c("Variable Name", "Description"), align = 'l')
``` 
  
  Some of the variables above may need further explanation as follows:  
  1. __Area__ - As this data set had to be built during a time where I needed to travel a lot and shift to a new apartment, I had to visit and stay at a few places before finally settling down in a new apartment. The values are namely 'Jc'-Jersey City, 'BK'-Brooklyn, 'NR'-New Rochelle, 'HAR'-Harrisburg, 'KOP'-King of Prussia and 'DVN'-Devon.  
  2. __Hrs..__ - This set of variables are mostly an approximate as they try to take into account distractions experienced in between. Further,'HrsYoutube' also includes the time I would play a music Playlist and leave it on in the background.
  3. __Mood__ - This categorical variable doesn't properly describe the changes in mood over the day but is an estimate of my overall mood at the end of the day.

## Analysis  
  
  We Start off by first loading the dataset and keeping it ready for analysis as follows:  
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
# Loading the data from the local .csv file
ProjectDat <- read.csv("~/GitHub/ANLY_512-50_SU2016_Project/src/ProjectDat.csv")

# Reassigning for ease of use and removing data from memory
dat<-ProjectDat
dat$Date<-as.Date(ProjectDat$Date,format="%m/%d/%y")
remove(ProjectDat)
```
  
  We Now move on to answering the first question of 'How well have I managed my expenditure?'. Put in other words, have I been able to keep within my limit of $60 per day? We can do this with some simple operations as follows:
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
# Count of the number of days I was successful in maintatining the limit
sum(dat$Total <= 60)

#Count of the number of the days I was unsuccessful in maintatining the limit
sum(dat$Total > 60)
```
  
  As we can see from the above counts, the number of times I have been successful and unsuccessful in maintating my limit is equal over the past 44 days. But this is not completely true due to the one time payments that needed to be made.Hence, essentialy, we put forward a new question, 'Have I kept my `daily requirements` expenditure less than $60?'. We calculate these as follows:

```{r,warning=FALSE,message=FALSE,echo=FALSE}
# Counting number of rows that satisfy the limit
nrow(dat[with(dat, (Groceries.Supplies+EatingOut+Uber) <=60),])
```  
  
  Based on the above conditions (if we exclude expenditure due to other reasons), I was able to keep within my 'daily requirements' budget for 29 days out of 44 days.  
  
  Next, we try to answer the question of 'How well have I distributed my time acroos activities?'. In order to do this we try to compare the averages over each week.  

```{r,warning=FALSE,message=FALSE,echo=FALSE}
# Subsetting the data for 
dath<-dat[,14:18]
dath$Total<-with(dath,HrsStudy+HrsRead+HrsYoutube+HrsNetflix+HrsESO)
weekly<-NULL
for(i in c(1,8,15,22,29,36,43)){
  weekly<-rbind(weekly,colSums(dath[i:(i+7),], na.rm = TRUE))
}
weeklyratio<-NULL
for(i in 1:nrow(weekly)){
  weeklyratio<-rbind(weeklyratio,weekly[i,]/weekly[i,6])
}
weeklyratio
```  
  
  From the above matrix of ratios we can see that for the most part, time allocated is distributed unevenly per week which indicates that better management of time would be required.(personal opinion)
  
  Next we try to answer the question on 'Whether spending time on any particular activity have an effect on my overall mood?'. We do this by seeing the correlation among variables as follows:  
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
datc<-dat[,13:19]
datc$Mcode[datc$Mood=="Good"]<-"3"
datc$Mcode[datc$Mood=="Okay"]<-"2"
datc$Mcode[datc$Mood=="Bad"]<-"1"
cor(data.matrix(datc[-7]))
```  
  
  From the above correlation matrix we can see that when it comes to 'Mood', 'HrsNetflix' seems to have the most positive effect. The remaining covaraiates have a mix of negative and positive effect but not as much.  
  Next we try to answer the question of 'does the amount I walk have an effect on my sleep?'. We do this as follows:  
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
cor(dat[,c(11,13)])
```  
  
  From teh correlation matrix we see that it does have a decent effect, but let's take into account distance traveled as well. We do it as follows:
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
cor(dat[,c(10,11,13)])
```  
  
  From the above correlation matrix we can see that distance traveled has a negative correlation with the amount of sleep I get.  
  

## Visualization methods  
  
  In order to get a better idea through visualization means, we select the following visualization methods:
  
  1. The first question can be visualized better with the help of a line plot distinguished by the amount spent in each category (in our data frame they are separate variables)
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
# Setting up the data
datexp<-dat
exptemp<-gather(datexp, Category, Expenditure, Groceries.Supplies:Uber)

# Plotting the data
p1<-ggplot(data=exptemp, aes(x=Date,y=Expenditure,colour=Category))+geom_line()
p1
```  
  
  We could take it a step further by facetting the plot for clarity:
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
p2<-ggplot(data=exptemp, aes(x=Date,y=Expenditure,colour=Category))+geom_line()+facet_wrap(~Category, scales = "free")
p2
```

  2. The second question can be visualized better with the help of a line plot as follows:
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
# Setting up the data
dathrs<-dat
hrstemp<-gather(dathrs, Category, Hours.Spent, HrsStudy:HrsESO)

# Plotting the graphic
p3<-ggplot(data = hrstemp, aes(x=Date,y=Hours.Spent, colour=Category))+geom_line()
(gg<-ggplotly(p3))
# PLotting with facets
p4<-ggplot(data = hrstemp, aes(x=Date,y=Hours.Spent, colour=Category))+geom_line()+facet_wrap(~Category, scales = "free")
(gg<-ggplotly(p4))
```

  3. The third question can be better visualized with the help of a scatterplot as follows:  
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
# Setting up the data
datexp<-dat
hrsmood<-gather(datexp, Category, Hours.Spent, HrsStudy:HrsESO)

#Plotting the data
p5<-ggplot(data=hrsmood, aes(x=Date,y=Hours.Spent, colour=Mood))+geom_point(aes(text=paste("Category :",hrsmood$Category)))
(gg<-ggplotly(p5))
```  

  4. The final question can be better visualized with the help of a scatterplot keeping the distance travelled as a factor for the size of points.  
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
p6<-ggplot(data = dat, aes(x=DistWalk,y=HrsSleep, colour= DistTrav))+geom_point(aes(text=paste("Day :",dat$Day)))+geom_smooth()
(gg<-ggplotly(p6))
```